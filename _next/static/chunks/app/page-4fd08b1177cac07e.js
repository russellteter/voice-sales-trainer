(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{283:(e,s,t)=>{"use strict";t.d(s,{As:()=>c,OJ:()=>l});var a=t(5155),r=t(2115),n=t(5731);let i=(0,r.createContext)(void 0);function l(e){let{children:s}=e,[t,l]=(0,r.useState)(null),[c,o]=(0,r.useState)(!0);(0,r.useEffect)(()=>{d()},[]);let d=async()=>{o(!0);try{let e=await n.ZQ.getCurrentUser();e.data?l(e.data):e.error&&(0,n.HY)(e.status)&&(n.ZQ.logout(),l(null))}catch(e){console.error("Auth initialization failed:",e),n.ZQ.logout(),l(null)}finally{o(!1)}},u=async e=>{o(!0);try{let s=await n.ZQ.login(e);if(s.data)return l(s.data.user),{success:!0};if(s.error)return{success:!1,error:(0,n.hS)(s.error)};return{success:!1,error:"Login failed"}}catch(e){return console.error("Login error:",e),{success:!1,error:"Network error. Please try again."}}finally{o(!1)}},m=async e=>{o(!0);try{let s=await n.ZQ.register(e);if(s.data){let s=await n.ZQ.login({username:e.username,password:e.password});return s.data&&l(s.data.user),{success:!0}}if(s.error)return{success:!1,error:(0,n.hS)(s.error)};return{success:!1,error:"Registration failed"}}catch(e){return console.error("Registration error:",e),{success:!1,error:"Network error. Please try again."}}finally{o(!1)}},h=()=>{n.ZQ.logout(),l(null)},g=async()=>{try{let e=await n.ZQ.getCurrentUser();e.data?l(e.data):e.error&&(0,n.HY)(e.status)&&h()}catch(e){console.error("Failed to refresh user:",e),h()}};return(0,a.jsx)(i.Provider,{value:{user:t,isLoading:c,isAuthenticated:!!t,login:u,register:m,logout:h,refreshUser:g},children:s})}function c(){let e=(0,r.useContext)(i);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},5731:(e,s,t)=>{"use strict";t.d(s,{HK:()=>d,HY:()=>m,Rk:()=>o,ZQ:()=>l,h8:()=>c,hS:()=>u});let a="https://voice-sales-trainer-backend.up.railway.app",r=null;class n{async request(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t="".concat(this.baseUrl).concat(e),a={"Content-Type":"application/json",...s.headers};r&&(a.Authorization="Bearer ".concat(r));try{let e=await fetch(t,{...s,headers:a}),r=await e.json();if(!e.ok)return{error:r,status:e.status};return{data:r,status:e.status}}catch(e){return{error:{error:"Network Error",message:e instanceof Error?e.message:"Unknown network error"},status:0}}}async get(e){return this.request(e,{method:"GET"})}async post(e,s){return this.request(e,{method:"POST",body:s?JSON.stringify(s):void 0})}async put(e,s){return this.request(e,{method:"PUT",body:s?JSON.stringify(s):void 0})}async delete(e){return this.request(e,{method:"DELETE"})}setAuthToken(e){r=e,e?localStorage.setItem("auth_token",e):localStorage.removeItem("auth_token")}getAuthToken(){return r}isAuthenticated(){return!!r}constructor(e=a){this.baseUrl=e,r=localStorage.getItem("auth_token")}}let i=new n,l={async login(e){let s=new FormData;s.append("username",e.username),s.append("password",e.password);let t=await fetch("".concat(a,"/auth/token"),{method:"POST",body:s}),r=await t.json();return t.ok?(i.setAuthToken(r.access_token),{data:r,status:t.status}):{error:r,status:t.status}},register:async e=>i.post("/auth/register",e),getCurrentUser:async()=>i.get("/auth/me"),async logout(){i.setAuthToken(null)},refreshToken:async()=>i.post("/auth/refresh")},c={async getAll(e){let s="/scenarios";if(e){let t=new URLSearchParams;e.category&&"All"!==e.category&&t.append("category",e.category),e.difficulty&&"All"!==e.difficulty&&t.append("difficulty",e.difficulty),e.persona&&"All"!==e.persona&&t.append("persona",e.persona),e.search&&t.append("search",e.search);let a=t.toString();a&&(s+="?".concat(a))}return i.get(s)},getById:async e=>i.get("/scenarios/".concat(e)),getFeatured:async()=>i.get("/scenarios/featured")},o={create:async e=>i.post("/sessions",e),getById:async e=>i.get("/sessions/".concat(e)),async getUserSessions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:20;return i.get("/sessions?limit=".concat(e))},updateSession:async(e,s)=>i.put("/sessions/".concat(e),s),completeSession:async e=>i.post("/sessions/".concat(e,"/complete")),pauseSession:async e=>i.post("/sessions/".concat(e,"/pause")),resumeSession:async e=>i.post("/sessions/".concat(e,"/resume")),getAnalytics:async()=>i.get("/sessions/analytics"),addMessage:async(e,s)=>i.post("/sessions/".concat(e,"/messages"),s)},d={processVoice:async e=>i.post("/voice/process",e),startVoiceSession:async e=>i.post("/voice/sessions/".concat(e,"/start")),endVoiceSession:async e=>i.post("/voice/sessions/".concat(e,"/end"))},u=e=>e.message?e.message:e.error?e.error:"An unexpected error occurred",m=e=>401===e||403===e;i.setAuthToken(i.getAuthToken())},6588:(e,s,t)=>{Promise.resolve().then(t.bind(t,7898))},7898:(e,s,t)=>{"use strict";t.d(s,{default:()=>m});var a=t(5155),r=t(2115),n=t(5731),i=t(283),l=t(9509);let c={development:{api:{baseUrl:"https://voice-sales-trainer-backend.up.railway.app",timeout:3e4,retryAttempts:3},features:{voiceEnabled:!0,claudeEnabled:!0,realTimeCoaching:!0,voiceAnalytics:!0,peerComparison:!1,achievementSystem:!0,offlineMode:!1},voice:{sampleRate:16e3,chunkSize:1024,silenceThreshold:.01,maxRecordingTime:3e5,enableNoiseReduction:!0,enableEchoCancellation:!0},ui:{theme:"light",animations:!0,compactMode:!1,debugMode:!0},analytics:{enabled:!1,sessionTracking:!0,errorReporting:!0}},staging:{api:{baseUrl:"https://voice-sales-trainer-backend.up.railway.app",timeout:15e3,retryAttempts:2},features:{voiceEnabled:!0,claudeEnabled:!0,realTimeCoaching:!0,voiceAnalytics:!0,peerComparison:!0,achievementSystem:!0,offlineMode:!1},voice:{sampleRate:16e3,chunkSize:1024,silenceThreshold:.01,maxRecordingTime:6e5,enableNoiseReduction:!0,enableEchoCancellation:!0},ui:{theme:"light",animations:!0,compactMode:!1,debugMode:!1},analytics:{enabled:!0,sessionTracking:!0,errorReporting:!0}},production:{api:{baseUrl:"https://voice-sales-trainer-backend.up.railway.app",timeout:1e4,retryAttempts:1},features:{voiceEnabled:!0,claudeEnabled:!0,realTimeCoaching:!0,voiceAnalytics:!0,peerComparison:!0,achievementSystem:!0,offlineMode:!1},voice:{sampleRate:16e3,chunkSize:1024,silenceThreshold:.01,maxRecordingTime:9e5,enableNoiseReduction:!0,enableEchoCancellation:!0},ui:{theme:"auto",animations:!0,compactMode:!1,debugMode:!1},analytics:{enabled:!0,sessionTracking:!0,errorReporting:!0}}},o={api:{baseUrl:"http://localhost:8000",timeout:3e4,retryAttempts:3},features:{voiceEnabled:!1,claudeEnabled:!1,realTimeCoaching:!0,voiceAnalytics:!0,peerComparison:!1,achievementSystem:!0,offlineMode:!1},voice:{sampleRate:16e3,chunkSize:1024,silenceThreshold:.01,maxRecordingTime:3e5,enableNoiseReduction:!0,enableEchoCancellation:!0},ui:{theme:"light",animations:!0,compactMode:!1,debugMode:!1},analytics:{enabled:!1,sessionTracking:!0,errorReporting:!0}},d=(()=>{let e=c.production||{};return{...o,api:{...o.api,...e.api},features:{...o.features,...e.features},voice:{...o.voice,...e.voice},ui:{...o.ui,...e.ui},analytics:{...o.analytics,...e.analytics}}})(),u=e=>d.features[e];function m(){var e;let[s,t]=(0,r.useState)(null),[l,c]=(0,r.useState)([]),[o,u]=(0,r.useState)(null),[m,h]=(0,r.useState)(!1),[g,x]=(0,r.useState)(0),[p,y]=(0,r.useState)(null),[b,f]=(0,r.useState)([]),[v,j]=(0,r.useState)(!0),[N,w]=(0,r.useState)(null),{isAuthenticated:S,user:k}=(0,i.As)(),C=(0,r.useRef)(null);(0,r.useEffect)(()=>{S&&A()},[S]),(0,r.useEffect)(()=>(m?C.current=setInterval(()=>{x(e=>e+1)},1e3):C.current&&clearInterval(C.current),()=>{C.current&&clearInterval(C.current)}),[m]);let A=async()=>{j(!0),w(null);try{let e=await n.h8.getAll();e.data?c(e.data):e.error&&w((0,n.hS)(e.error))}catch(e){w("Failed to load scenarios. Please try again."),console.error("Error loading scenarios:",e)}finally{j(!1)}},T=async e=>{t(e),w(null);try{let s={scenario_id:parseInt(e.id),is_practice_mode:!0},t=await n.Rk.create(s);t.data?u({id:t.data.id.toString(),scenario:e.title,status:"idle",duration:0,apiSession:t.data}):t.error&&w((0,n.hS)(t.error))}catch(e){w("Failed to create training session."),console.error("Error creating session:",e)}},E=async()=>{try{let e=await navigator.mediaDevices.getUserMedia({audio:!0}),s=new MediaRecorder(e);s.ondataavailable=e=>{e.data.size>0&&f(s=>[...s,e.data])},s.onstop=()=>{e.getTracks().forEach(e=>e.stop())},y(s),f([]),s.start(),h(!0),x(0),o&&u(e=>e?{...e,status:"recording"}:null)}catch(e){console.error("Error starting recording:",e),alert("Could not access microphone. Please check permissions.")}},R=async()=>{if(p&&"recording"===p.state&&(p.stop(),h(!1),o)){u(e=>e?{...e,status:"processing",duration:g}:null);try{let s=new Blob(b,{type:"audio/wav"}),t=await M(s);if(d.features.voiceEnabled&&o.apiSession){let s=await n.HK.processVoice({session_id:o.apiSession.id,audio_data:t,step:o.apiSession.current_step});if(s.data){var e;u(e=>{var t,a;return e?{...e,status:"complete",score:(null==(t=s.data)?void 0:t.score_update)||Math.floor(40*Math.random())+60,feedback:[(null==(a=s.data)?void 0:a.feedback)||"Session completed successfully"]}:null}),(null==(e=s.data)?void 0:e.session_complete)&&await n.Rk.completeSession(o.apiSession.id)}else throw Error("Voice processing failed")}else setTimeout(()=>{u(e=>e?{...e,status:"complete",score:Math.floor(40*Math.random())+60,feedback:["Strong opening with clear value proposition","Consider asking more discovery questions early","Great handling of the price objection","Could improve closing technique with more urgency"]}:null)},2e3)}catch(e){console.error("Error processing recording:",e),w("Failed to process recording. Please try again."),u(e=>e?{...e,status:"idle"}:null)}}},D=e=>{let s=Math.floor(e/60);return"".concat(s,":").concat((e%60).toString().padStart(2,"0"))},M=e=>new Promise((s,t)=>{let a=new FileReader;a.onload=()=>{s(a.result.split(",")[1])},a.onerror=t,a.readAsDataURL(e)});return S?(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-4",children:(0,a.jsxs)("div",{className:"max-w-6xl mx-auto",children:[(0,a.jsxs)("header",{className:"text-center mb-8",children:[(0,a.jsx)("h1",{className:"text-4xl font-bold text-gray-900 mb-2",children:"Voice Sales Trainer"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Practice your sales conversations with AI-powered role-play scenarios"}),k&&(0,a.jsxs)("p",{className:"text-sm text-blue-600 mt-2",children:["Welcome back, ",k.first_name||k.username,"!"]})]}),N&&(0,a.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"text-red-500 mr-3",children:"⚠️"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-red-800 font-medium",children:"Error"}),(0,a.jsx)("p",{className:"text-red-600 text-sm",children:N}),(0,a.jsx)("button",{onClick:()=>w(null),className:"mt-2 text-sm text-red-600 hover:text-red-800 underline",children:"Dismiss"})]})]})}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,a.jsx)("div",{className:"lg:col-span-1",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-4 flex items-center",children:"\uD83C\uDFAF Training Scenarios"}),v?(0,a.jsxs)("div",{className:"flex items-center justify-center py-8",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),(0,a.jsx)("span",{className:"ml-3 text-gray-600",children:"Loading scenarios..."})]}):(0,a.jsx)("div",{className:"space-y-3",children:l.map(e=>(0,a.jsxs)("div",{className:"p-4 rounded-lg border-2 cursor-pointer transition-all ".concat((null==s?void 0:s.id)===e.id?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300 hover:shadow-md"),onClick:()=>T(e),children:[(0,a.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,a.jsx)("h3",{className:"font-medium text-gray-900",children:e.title}),(0,a.jsx)("span",{className:"px-2 py-1 text-xs rounded-full ".concat("Beginner"===e.difficulty?"bg-green-100 text-green-800":"Intermediate"===e.difficulty?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"),children:e.difficulty})]}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-2",children:e.description}),(0,a.jsx)("span",{className:"inline-block px-2 py-1 text-xs bg-gray-100 text-gray-700 rounded",children:e.category})]},e.id))}),!v&&0===l.length&&(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)("p",{className:"text-gray-500",children:"No scenarios available"}),(0,a.jsx)("button",{onClick:A,className:"mt-2 text-blue-600 hover:text-blue-700 text-sm underline",children:"Retry"})]})]})}),(0,a.jsx)("div",{className:"lg:col-span-2",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-4 flex items-center",children:"\uD83C\uDF99️ Voice Training Session"}),s?(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 mb-6",children:[(0,a.jsx)("h3",{className:"font-medium text-gray-900 mb-2",children:s.title}),(0,a.jsx)("p",{className:"text-gray-600 text-sm",children:s.description})]}),(0,a.jsxs)("div",{className:"text-center mb-6",children:[(null==o?void 0:o.status)==="idle"&&(0,a.jsx)("button",{onClick:E,className:"inline-flex items-center px-6 py-3 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:"\uD83C\uDFA4 Start Recording"}),m&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-center space-x-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"w-3 h-3 bg-red-500 rounded-full animate-pulse"}),(0,a.jsx)("span",{className:"text-red-600 font-medium",children:"Recording"})]}),(0,a.jsx)("span",{className:"text-2xl font-mono text-gray-900",children:D(g)})]}),(0,a.jsx)("button",{onClick:R,className:"inline-flex items-center px-6 py-3 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",children:"⏹️ Stop Recording"})]}),(null==o?void 0:o.status)==="processing"&&(0,a.jsxs)("div",{className:"flex items-center justify-center space-x-2",children:[(0,a.jsx)("div",{className:"animate-spin text-blue-600",children:"\uD83D\uDD04"}),(0,a.jsx)("span",{className:"text-blue-600",children:"Processing your recording..."})]})]}),(null==o?void 0:o.status)==="complete"&&(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"bg-green-50 rounded-lg p-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("h4",{className:"font-medium text-green-900",children:"Session Score"}),(0,a.jsxs)("span",{className:"text-2xl font-bold text-green-600",children:[o.score,"/100"]})]}),(0,a.jsx)("div",{className:"w-full bg-green-200 rounded-full h-2",children:(0,a.jsx)("div",{className:"bg-green-600 h-2 rounded-full",style:{width:"".concat(o.score,"%")}})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-medium text-gray-900 mb-3 flex items-center",children:"\uD83D\uDCC8 Detailed Feedback"}),(0,a.jsx)("ul",{className:"space-y-2",children:null==(e=o.feedback)?void 0:e.map((e,s)=>(0,a.jsxs)("li",{className:"flex items-start space-x-2",children:[(0,a.jsx)("span",{className:"w-2 h-2 bg-blue-500 rounded-full mt-2 flex-shrink-0"}),(0,a.jsx)("span",{className:"text-gray-700",children:e})]},s))})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 text-center",children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Duration"}),(0,a.jsx)("p",{className:"text-lg font-semibold text-gray-900",children:D(o.duration)})]}),(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 text-center",children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Scenario"}),(0,a.jsx)("p",{className:"text-lg font-semibold text-gray-900",children:s.difficulty})]})]}),(0,a.jsxs)("div",{className:"flex space-x-3",children:[(0,a.jsx)("button",{onClick:()=>E(),className:"flex-1 bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors",children:"Try Again"}),(0,a.jsx)("button",{onClick:()=>{u(null),t(null),h(!1),x(0),f([])},className:"flex-1 bg-gray-600 text-white py-2 px-4 rounded-lg hover:bg-gray-700 transition-colors",children:"New Scenario"})]})]})]}):(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)("div",{className:"text-6xl mb-4",children:"\uD83D\uDC64"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Select a training scenario to get started"})]})]})})]}),(0,a.jsxs)("div",{className:"mt-8 bg-white rounded-lg shadow-lg p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"How to Use Voice Sales Trainer"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center mx-auto mb-3",children:(0,a.jsx)("span",{className:"text-blue-600 font-bold",children:"1"})}),(0,a.jsx)("h4",{className:"font-medium mb-2",children:"Choose Scenario"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Select a sales scenario that matches your training goals"})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center mx-auto mb-3",children:(0,a.jsx)("span",{className:"text-green-600 font-bold",children:"2"})}),(0,a.jsx)("h4",{className:"font-medium mb-2",children:"Record Practice"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Practice your sales conversation out loud and record it"})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center mx-auto mb-3",children:(0,a.jsx)("span",{className:"text-purple-600 font-bold",children:"3"})}),(0,a.jsx)("h4",{className:"font-medium mb-2",children:"Get Feedback"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Receive AI-powered feedback to improve your technique"})]})]})]})]})}):(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-4",children:(0,a.jsx)("div",{className:"max-w-6xl mx-auto",children:(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-lg p-12",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-6xl mb-4",children:"\uD83D\uDD12"}),(0,a.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Authentication Required"}),(0,a.jsx)("p",{className:"text-gray-600 mb-6",children:"Please log in to access the voice training interface."}),(0,a.jsxs)("div",{className:"space-x-4",children:[(0,a.jsx)("button",{className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition duration-200",children:"Login"}),(0,a.jsx)("button",{className:"border border-gray-300 text-gray-700 px-6 py-2 rounded-lg hover:bg-gray-50 transition duration-200",children:"Sign Up"})]})]})})})})}u("voiceEnabled"),u("claudeEnabled"),u("realTimeCoaching"),u("voiceAnalytics"),u("peerComparison"),u("achievementSystem"),u("offlineMode"),(()=>{let e=["NEXT_PUBLIC_API_URL"].filter(e=>!l.env[e]);e.length>0&&console.warn("Missing required environment variables: ".concat(e.join(", "))),d.ui.debugMode&&console.warn("Debug mode is enabled in production")})()}},e=>{e.O(0,[441,964,358],()=>e(e.s=6588)),_N_E=e.O()}]);